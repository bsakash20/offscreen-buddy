{"version":3,"names":["_asyncStorage","_interopRequireDefault","require","_EncryptionService","_SecurityMonitor","PrivacyManager","exports","_classCallCheck2","default","consentRecords","Map","auditLogs","privacySettings","analyticsEnabled","marketingEnabled","dataRetentionDays","consentTimestamp","withdrawalTimestamp","region","detectRegion","gdprCompliant","ccpaCompliant","encryptionService","EncryptionService","securityMonitor","SecurityMonitor","_createClass2","key","value","_initialize","_asyncToGenerator2","userId","loadPrivacySettings","initializeConsentManagement","scheduleDataCleanup","logSecurityEvent","error","console","Error","initialize","_x","apply","arguments","_recordConsent","consentData","validation","validateConsentData","valid","success","consentRecord","id","generateConsentId","consentType","granted","timestamp","Date","ipAddress","getDeviceInfo","userAgent","purpose","retentionPeriod","userConsents","get","push","set","storeConsentRecord","updatePrivacySettingsFromConsent","logPrivacyAction","message","recordConsent","_x2","_x3","_withdrawConsent","withdrawalRecord","stopDataProcessing","withdrawConsent","_x4","_x5","_exportUserData","canExport","checkDataExportCompliance","allowed","reason","userData","collectUserData","exportPackage","exportTimestamp","getConsentRecords","personalData","metadata","exportFormat","schema","version","encryptedExport","encrypt","JSON","stringify","storeDataExportRecord","dataTypes","Object","keys","length","data","exportUserData","_x6","_deleteUserData","deletionType","undefined","canDelete","checkDataDeletionCompliance","performCompleteDataDeletion","clearAllUserData","performPartialDataDeletion","deleteUserData","_x7","getPrivacySettings","assign","_updatePrivacySettings","updates","storePrivacySettings","updatePrivacySettings","_x8","_x9","_updatePrivacySettingsFromConsent","_x0","_x1","_getConsentRecords","storedConsents","loadConsentRecords","allConsents","concat","_toConsumableArray2","uniqueConsents","filter","consent","index","self","findIndex","c","sort","a","b","getTime","_x10","_generateAuditReport","dateRange","filteredLogs","log","from","to","complianceStatus","assessComplianceStatus","auditReport","reportGenerated","now","summary","totalActions","consentChanges","action","includes","dataExports","dataDeletions","report","generateAuditReport","_x11","_x12","validTypes","Math","random","toString","substring","_getDeviceInfo","infoType","_x13","_initializeConsentManagement","existingConsents","_x14","_scheduleDataCleanup","_this","cleanupInterval","setInterval","performScheduledDataCleanup","_x15","_loadPrivacySettings","stored","AsyncStorage","getItem","parsed","parse","_x16","_storePrivacySettings","setItem","_x17","_storeConsentRecord","record","records","_x18","_x19","_loadConsentRecords","map","_x20","_stopDataProcessing","_x21","_x22","_collectUserData","_x23","_checkDataExportCompliance","essentialConsent","find","_x24","_storeDataExportRecord","exportData","_x25","_x26","_checkDataDeletionCompliance","_x27","_x28","_performCompleteDataDeletion","clear","_x29","_performPartialDataDeletion","keysToRemove","removeItem","_x30","_clearAllUserData","allKeys","getAllKeys","userKeys","_x31","_performScheduledDataCleanup","cutoffDate","validConsents","_x32","_logPrivacyAction","auditLog","auditTrail","slice","_x33","_x34","_x35","logs","violations","pending","privacyManager"],"sources":["PrivacyManager.ts"],"sourcesContent":["/**\n * Privacy Management Service\n * GDPR/CCPA compliance and privacy-by-design framework\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\nimport { supabase } from '../Supabase/supabase';\nimport { EncryptionService } from './EncryptionService';\nimport { SecurityMonitor } from './SecurityMonitor';\n\nexport interface PrivacySettings {\n    analyticsEnabled: boolean;\n    marketingEnabled: boolean;\n    dataRetentionDays: number;\n    consentTimestamp: Date | null;\n    withdrawalTimestamp: Date | null;\n    region: string;\n    gdprCompliant: boolean;\n    ccpaCompliant: boolean;\n}\n\nexport interface ConsentRecord {\n    id: string;\n    userId: string;\n    consentType: 'essential' | 'analytics' | 'marketing' | 'personalization';\n    granted: boolean;\n    timestamp: Date;\n    ipAddress: string;\n    userAgent: string;\n    purpose: string;\n    retentionPeriod: number;\n}\n\nexport interface DataSubject {\n    userId: string;\n    email: string;\n    personalData: Record<string, any>;\n    consentRecords: ConsentRecord[];\n    lastProcessed: Date;\n    deletionScheduled?: Date;\n    exportGenerated?: Date;\n}\n\nexport interface PrivacyAuditLog {\n    id: string;\n    timestamp: Date;\n    action: 'consent_granted' | 'consent_withdrawn' | 'data_exported' | 'data_deleted' | 'data_accessed';\n    userId: string;\n    dataTypes: string[];\n    complianceStatus: 'compliant' | 'pending' | 'violation';\n    auditTrail: any;\n}\n\nexport class PrivacyManager {\n    private privacySettings: PrivacySettings;\n    private encryptionService: EncryptionService;\n    private securityMonitor: SecurityMonitor;\n    private consentRecords: Map<string, ConsentRecord[]> = new Map();\n    private auditLogs: PrivacyAuditLog[] = [];\n\n    constructor() {\n        this.privacySettings = {\n            analyticsEnabled: false,\n            marketingEnabled: false,\n            dataRetentionDays: 365, // Default 1 year\n            consentTimestamp: null,\n            withdrawalTimestamp: null,\n            region: this.detectRegion(),\n            gdprCompliant: true,\n            ccpaCompliant: true\n        };\n        this.encryptionService = new EncryptionService();\n        this.securityMonitor = new SecurityMonitor();\n    }\n\n    /**\n     * Initialize privacy manager and load user settings\n     */\n    async initialize(userId: string): Promise<void> {\n        try {\n            // Load privacy settings from storage/database\n            await this.loadPrivacySettings(userId);\n\n            // Set up consent management\n            await this.initializeConsentManagement(userId);\n\n            // Schedule data cleanup tasks\n            await this.scheduleDataCleanup(userId);\n\n            await this.securityMonitor.logSecurityEvent('privacy_manager_initialized', {\n                userId,\n                region: this.privacySettings.region,\n                gdprCompliant: this.privacySettings.gdprCompliant\n            });\n\n        } catch (error) {\n            console.error('Failed to initialize privacy manager:', error);\n            throw new Error('Privacy manager initialization failed');\n        }\n    }\n\n    /**\n     * Record user consent for specific data processing\n     */\n    async recordConsent(\n        userId: string,\n        consentData: {\n            consentType: 'essential' | 'analytics' | 'marketing' | 'personalization';\n            granted: boolean;\n            purpose: string;\n            retentionPeriod: number;\n        }\n    ): Promise<{ success: boolean; error?: string }> {\n        try {\n            // Validate consent data\n            const validation = this.validateConsentData(consentData);\n            if (!validation.valid) {\n                return { success: false, error: validation.error };\n            }\n\n            // Create consent record\n            const consentRecord: ConsentRecord = {\n                id: this.generateConsentId(),\n                userId,\n                consentType: consentData.consentType,\n                granted: consentData.granted,\n                timestamp: new Date(),\n                ipAddress: await this.getDeviceInfo('ip') || 'unknown',\n                userAgent: await this.getDeviceInfo('userAgent') || 'unknown',\n                purpose: consentData.purpose,\n                retentionPeriod: consentData.retentionPeriod\n            };\n\n            // Store consent record\n            const userConsents = this.consentRecords.get(userId) || [];\n            userConsents.push(consentRecord);\n            this.consentRecords.set(userId, userConsents);\n\n            // Store securely\n            await this.storeConsentRecord(userId, consentRecord);\n\n            // Update privacy settings\n            await this.updatePrivacySettingsFromConsent(userId, consentData);\n\n            // Log audit event\n            await this.logPrivacyAction('consent_granted', userId, [consentData.consentType]);\n\n            // Update local settings\n            this.privacySettings.consentTimestamp = new Date();\n            this.privacySettings.marketingEnabled = consentData.consentType === 'marketing' ? consentData.granted : this.privacySettings.marketingEnabled;\n            this.privacySettings.analyticsEnabled = consentData.consentType === 'analytics' ? consentData.granted : this.privacySettings.analyticsEnabled;\n\n            await this.securityMonitor.logSecurityEvent('privacy_consent_recorded', {\n                userId,\n                consentType: consentData.consentType,\n                granted: consentData.granted,\n                purpose: consentData.purpose\n            });\n\n            return { success: true };\n\n        } catch (error) {\n            console.error('Failed to record consent:', error);\n            await this.securityMonitor.logSecurityEvent('privacy_consent_failed', {\n                userId,\n                error: error instanceof Error ? error.message : 'Unknown error'\n            });\n            return { success: false, error: 'Failed to record consent' };\n        }\n    }\n\n    /**\n     * Withdraw consent for specific data processing\n     */\n    async withdrawConsent(\n        userId: string,\n        consentType: 'essential' | 'analytics' | 'marketing' | 'personalization'\n    ): Promise<{ success: boolean; error?: string }> {\n        try {\n            // Essential consent cannot be withdrawn\n            if (consentType === 'essential') {\n                return { success: false, error: 'Essential consent cannot be withdrawn' };\n            }\n\n            // Create withdrawal record\n            const withdrawalRecord: ConsentRecord = {\n                id: this.generateConsentId(),\n                userId,\n                consentType,\n                granted: false,\n                timestamp: new Date(),\n                ipAddress: await this.getDeviceInfo('ip') || 'unknown',\n                userAgent: await this.getDeviceInfo('userAgent') || 'unknown',\n                purpose: 'Consent withdrawal',\n                retentionPeriod: 0\n            };\n\n            // Store withdrawal record\n            const userConsents = this.consentRecords.get(userId) || [];\n            userConsents.push(withdrawalRecord);\n            this.consentRecords.set(userId, userConsents);\n\n            await this.storeConsentRecord(userId, withdrawalRecord);\n\n            // Update privacy settings\n            if (consentType === 'marketing') {\n                this.privacySettings.marketingEnabled = false;\n            } else if (consentType === 'analytics') {\n                this.privacySettings.analyticsEnabled = false;\n            }\n\n            this.privacySettings.withdrawalTimestamp = new Date();\n\n            // Immediately stop data processing for withdrawn consent\n            await this.stopDataProcessing(userId, consentType);\n\n            // Log audit event\n            await this.logPrivacyAction('consent_withdrawn', userId, [consentType]);\n\n            await this.securityMonitor.logSecurityEvent('privacy_consent_withdrawn', {\n                userId,\n                consentType\n            });\n\n            return { success: true };\n\n        } catch (error) {\n            console.error('Failed to withdraw consent:', error);\n            return { success: false, error: 'Failed to withdraw consent' };\n        }\n    }\n\n    /**\n     * Export user data for data portability (GDPR Article 20)\n     */\n    async exportUserData(userId: string): Promise<{\n        success: boolean;\n        data?: any;\n        error?: string;\n    }> {\n        try {\n            // Check if data export is allowed\n            const canExport = await this.checkDataExportCompliance(userId);\n            if (!canExport.allowed) {\n                return { success: false, error: canExport.reason };\n            }\n\n            // Collect all user data\n            const userData = await this.collectUserData(userId);\n\n            // Create export package\n            const exportPackage = {\n                userId,\n                exportTimestamp: new Date(),\n                privacySettings: this.privacySettings,\n                consentRecords: await this.getConsentRecords(userId),\n                personalData: userData,\n                metadata: {\n                    exportFormat: 'JSON',\n                    schema: 'GDPR_Article_20_Compliant',\n                    version: '1.0'\n                }\n            };\n\n            // Encrypt export data\n            const encryptedExport = await this.encryptionService.encrypt(JSON.stringify(exportPackage));\n\n            // Store export record\n            await this.storeDataExportRecord(userId, exportPackage);\n\n            // Log audit event\n            await this.logPrivacyAction('data_exported', userId, ['all']);\n\n            await this.securityMonitor.logSecurityEvent('privacy_data_exported', {\n                userId,\n                dataTypes: Object.keys(userData).length\n            });\n\n            return {\n                success: true,\n                data: encryptedExport\n            };\n\n        } catch (error) {\n            console.error('Data export failed:', error);\n            await this.securityMonitor.logSecurityEvent('privacy_data_export_failed', {\n                userId,\n                error: error instanceof Error ? error.message : 'Unknown error'\n            });\n            return {\n                success: false,\n                error: 'Data export failed'\n            };\n        }\n    }\n\n    /**\n     * Delete user data (Right to Erasure - GDPR Article 17)\n     */\n    async deleteUserData(userId: string, deletionType: 'partial' | 'complete' = 'partial'): Promise<{\n        success: boolean;\n        error?: string;\n    }> {\n        try {\n            // Check deletion compliance\n            const canDelete = await this.checkDataDeletionCompliance(userId, deletionType);\n            if (!canDelete.allowed) {\n                return { success: false, error: canDelete.reason };\n            }\n\n            if (deletionType === 'complete') {\n                // Complete data deletion\n                await this.performCompleteDataDeletion(userId);\n                await this.clearAllUserData(userId);\n            } else {\n                // Partial deletion (remove only non-essential data)\n                await this.performPartialDataDeletion(userId);\n            }\n\n            // Log audit event\n            await this.logPrivacyAction('data_deleted', userId, [deletionType]);\n\n            await this.securityMonitor.logSecurityEvent('privacy_data_deleted', {\n                userId,\n                deletionType\n            });\n\n            return { success: true };\n\n        } catch (error) {\n            console.error('Data deletion failed:', error);\n            await this.securityMonitor.logSecurityEvent('privacy_data_deletion_failed', {\n                userId,\n                error: error instanceof Error ? error.message : 'Unknown error'\n            });\n            return { success: false, error: 'Data deletion failed' };\n        }\n    }\n\n    /**\n     * Get current privacy settings\n     */\n    getPrivacySettings(): PrivacySettings {\n        return { ...this.privacySettings };\n    }\n\n    /**\n     * Update privacy settings\n     */\n    async updatePrivacySettings(userId: string, updates: Partial<PrivacySettings>): Promise<void> {\n        this.privacySettings = { ...this.privacySettings, ...updates };\n        await this.storePrivacySettings(userId);\n    }\n\n    /**\n     * Update privacy settings from consent data\n     */\n    private async updatePrivacySettingsFromConsent(userId: string, consentData: any): Promise<void> {\n        const updates: Partial<PrivacySettings> = {};\n\n        if (consentData.consentType === 'analytics') {\n            updates.analyticsEnabled = consentData.granted;\n        } else if (consentData.consentType === 'marketing') {\n            updates.marketingEnabled = consentData.granted;\n        }\n\n        await this.updatePrivacySettings(userId, updates);\n    }\n\n    /**\n     * Get consent records for user\n     */\n    async getConsentRecords(userId: string): Promise<ConsentRecord[]> {\n        const userConsents = this.consentRecords.get(userId) || [];\n        const storedConsents = await this.loadConsentRecords(userId);\n\n        // Merge and deduplicate\n        const allConsents = [...userConsents, ...storedConsents];\n        const uniqueConsents = allConsents.filter((consent, index, self) =>\n            index === self.findIndex(c => c.id === consent.id)\n        );\n\n        return uniqueConsents.sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime());\n    }\n\n    /**\n     * Generate privacy audit report\n     */\n    async generateAuditReport(userId: string, dateRange?: { from: Date; to: Date }): Promise<{\n        success: boolean;\n        report?: any;\n        error?: string;\n    }> {\n        try {\n            // Filter audit logs for date range\n            let filteredLogs = this.auditLogs.filter(log => log.userId === userId);\n\n            if (dateRange) {\n                filteredLogs = filteredLogs.filter(log =>\n                    log.timestamp >= dateRange.from && log.timestamp <= dateRange.to\n                );\n            }\n\n            // Generate compliance status\n            const complianceStatus = this.assessComplianceStatus(filteredLogs);\n\n            // Generate report\n            const auditReport = {\n                userId,\n                reportGenerated: new Date(),\n                dateRange: dateRange || { from: new Date(Date.now() - 365 * 24 * 60 * 60 * 1000), to: new Date() },\n                auditLogs: filteredLogs,\n                complianceStatus,\n                summary: {\n                    totalActions: filteredLogs.length,\n                    consentChanges: filteredLogs.filter(log => log.action.includes('consent')).length,\n                    dataExports: filteredLogs.filter(log => log.action === 'data_exported').length,\n                    dataDeletions: filteredLogs.filter(log => log.action === 'data_deleted').length\n                }\n            };\n\n            return { success: true, report: auditReport };\n\n        } catch (error) {\n            console.error('Failed to generate audit report:', error);\n            return { success: false, error: 'Failed to generate audit report' };\n        }\n    }\n\n    /**\n     * Private helper methods\n     */\n    private detectRegion(): string {\n        // In production, this would detect user's actual region\n        // For now, return a default\n        return 'EU'; // Default to GDPR jurisdiction\n    }\n\n    private validateConsentData(consentData: any): { valid: boolean; error?: string } {\n        const validTypes = ['essential', 'analytics', 'marketing', 'personalization'];\n\n        if (!validTypes.includes(consentData.consentType)) {\n            return { valid: false, error: 'Invalid consent type' };\n        }\n\n        if (typeof consentData.granted !== 'boolean') {\n            return { valid: false, error: 'Consent must be boolean' };\n        }\n\n        if (!consentData.purpose || consentData.purpose.length < 10) {\n            return { valid: false, error: 'Purpose must be clearly stated (min 10 characters)' };\n        }\n\n        if (consentData.retentionPeriod <= 0) {\n            return { valid: false, error: 'Retention period must be positive' };\n        }\n\n        return { valid: true };\n    }\n\n    private generateConsentId(): string {\n        return `consent_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`;\n    }\n\n    private async getDeviceInfo(infoType: 'ip' | 'userAgent'): Promise<string | undefined> {\n        // In production, get actual device info\n        return infoType === 'ip' ? '192.168.1.100' : 'OffScreenBuddy/1.0.0';\n    }\n\n    private async initializeConsentManagement(userId: string): Promise<void> {\n        // Load existing consent records\n        const existingConsents = await this.loadConsentRecords(userId);\n        this.consentRecords.set(userId, existingConsents);\n    }\n\n    private async scheduleDataCleanup(userId: string): Promise<void> {\n        // Schedule automatic data cleanup based on retention policy\n        const cleanupInterval = this.privacySettings.dataRetentionDays * 24 * 60 * 60 * 1000;\n\n        setInterval(async () => {\n            await this.performScheduledDataCleanup(userId);\n        }, cleanupInterval);\n    }\n\n    private async loadPrivacySettings(userId: string): Promise<void> {\n        try {\n            const stored = await AsyncStorage.getItem(`privacy_settings_${userId}`);\n            if (stored) {\n                const parsed = JSON.parse(stored);\n                this.privacySettings = { ...this.privacySettings, ...parsed };\n            }\n        } catch (error) {\n            console.error('Failed to load privacy settings:', error);\n        }\n    }\n\n    private async storePrivacySettings(userId: string): Promise<void> {\n        try {\n            await AsyncStorage.setItem(`privacy_settings_${userId}`, JSON.stringify(this.privacySettings));\n        } catch (error) {\n            console.error('Failed to store privacy settings:', error);\n        }\n    }\n\n    private async storeConsentRecord(userId: string, record: ConsentRecord): Promise<void> {\n        try {\n            const records = await this.loadConsentRecords(userId);\n            records.push(record);\n            await AsyncStorage.setItem(`consent_records_${userId}`, JSON.stringify(records));\n        } catch (error) {\n            console.error('Failed to store consent record:', error);\n        }\n    }\n\n    private async loadConsentRecords(userId: string): Promise<ConsentRecord[]> {\n        try {\n            const stored = await AsyncStorage.getItem(`consent_records_${userId}`);\n            if (stored) {\n                return JSON.parse(stored).map((record: any) => ({\n                    ...record,\n                    timestamp: new Date(record.timestamp)\n                }));\n            }\n        } catch (error) {\n            console.error('Failed to load consent records:', error);\n        }\n        return [];\n    }\n\n    private async stopDataProcessing(userId: string, consentType: string): Promise<void> {\n        // Immediately stop processing data for withdrawn consent\n        console.log(`üõë Stopping ${consentType} data processing for user ${userId}`);\n\n        // In production, would update analytics services, marketing platforms, etc.\n    }\n\n    private async collectUserData(userId: string): Promise<Record<string, any>> {\n        // Collect all user data from various sources\n        const userData: Record<string, any> = {};\n\n        try {\n            // Get user profile data\n            // const { data: profile } = await supabase.from('users').select('*').eq('id', userId).single();\n            // userData.profile = profile;\n\n            // Get session data\n            // const { data: sessions } = await supabase.from('user_sessions').select('*').eq('user_id', userId);\n            // userData.sessions = sessions;\n\n            // Get analytics data\n            // const { data: analytics } = await supabase.from('user_analytics').select('*').eq('user_id', userId);\n            // userData.analytics = analytics;\n\n            // Get consent records\n            const consentRecords = await this.getConsentRecords(userId);\n            userData.consentRecords = consentRecords;\n\n            // Get privacy settings\n            userData.privacySettings = this.privacySettings;\n\n        } catch (error) {\n            console.error('Failed to collect user data:', error);\n        }\n\n        return userData;\n    }\n\n    private async checkDataExportCompliance(userId: string): Promise<{ allowed: boolean; reason?: string }> {\n        // Check if user has necessary consents for data export\n        const consentRecords = await this.getConsentRecords(userId);\n\n        // Data export requires at least essential consent\n        const essentialConsent = consentRecords.find(c => c.consentType === 'essential' && c.granted);\n        if (!essentialConsent) {\n            return { allowed: false, reason: 'Essential consent required for data export' };\n        }\n\n        return { allowed: true };\n    }\n\n    private async storeDataExportRecord(userId: string, exportData: any): Promise<void> {\n        // Store record of data export for audit purposes\n        await AsyncStorage.setItem(`data_export_${userId}_${Date.now()}`, JSON.stringify(exportData));\n    }\n\n    private async checkDataDeletionCompliance(userId: string, deletionType: string): Promise<{ allowed: boolean; reason?: string }> {\n        // Check legal requirements for data deletion\n        if (deletionType === 'complete') {\n            // Check for ongoing legal obligations\n            // In production, would check against legal holds, ongoing investigations, etc.\n        }\n\n        return { allowed: true };\n    }\n\n    private async performCompleteDataDeletion(userId: string): Promise<void> {\n        // Delete all user data\n        console.log(`üóëÔ∏è Performing complete data deletion for user ${userId}`);\n\n        // Clear local storage\n        await AsyncStorage.clear();\n\n        // In production, would delete from all databases and services\n    }\n\n    private async performPartialDataDeletion(userId: string): Promise<void> {\n        // Delete only non-essential data\n        console.log(`üóëÔ∏è Performing partial data deletion for user ${userId}`);\n\n        // Keep essential data, remove analytics, marketing data, etc.\n        const keysToRemove = [\n            `analytics_${userId}`,\n            `marketing_${userId}`,\n            `personalization_${userId}`\n        ];\n\n        for (const key of keysToRemove) {\n            await AsyncStorage.removeItem(key);\n        }\n    }\n\n    private async clearAllUserData(userId: string): Promise<void> {\n        // Clear all data for user\n        const allKeys = await AsyncStorage.getAllKeys();\n        const userKeys = allKeys.filter(key => key.includes(userId));\n\n        for (const key of userKeys) {\n            await AsyncStorage.removeItem(key);\n        }\n    }\n\n    private async performScheduledDataCleanup(userId: string): Promise<void> {\n        // Clean up data based on retention policy\n        console.log(`üßπ Performing scheduled data cleanup for user ${userId}`);\n\n        const cutoffDate = new Date(Date.now() - this.privacySettings.dataRetentionDays * 24 * 60 * 60 * 1000);\n\n        // Clean up old audit logs\n        this.auditLogs = this.auditLogs.filter(log => log.timestamp > cutoffDate);\n\n        // Clean up old consent records\n        const userConsents = this.consentRecords.get(userId) || [];\n        const validConsents = userConsents.filter(consent => consent.timestamp > cutoffDate);\n        this.consentRecords.set(userId, validConsents);\n    }\n\n    private async logPrivacyAction(\n        action: PrivacyAuditLog['action'],\n        userId: string,\n        dataTypes: string[]\n    ): Promise<void> {\n        const auditLog: PrivacyAuditLog = {\n            id: `audit_${Date.now()}_${Math.random().toString(36).substring(2, 9)}`,\n            timestamp: new Date(),\n            action,\n            userId,\n            dataTypes,\n            complianceStatus: 'compliant',\n            auditTrail: {}\n        };\n\n        this.auditLogs.push(auditLog);\n\n        // Keep only recent audit logs in memory\n        if (this.auditLogs.length > 1000) {\n            this.auditLogs = this.auditLogs.slice(-1000);\n        }\n    }\n\n    private assessComplianceStatus(logs: PrivacyAuditLog[]): string {\n        const violations = logs.filter(log => log.complianceStatus === 'violation');\n        const pending = logs.filter(log => log.complianceStatus === 'pending');\n\n        if (violations.length > 0) {\n            return 'violation';\n        } else if (pending.length > 0) {\n            return 'pending';\n        } else {\n            return 'compliant';\n        }\n    }\n}\n\n// Export singleton instance\nexport const privacyManager = new PrivacyManager();"],"mappings":"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","ignoreList":[]}