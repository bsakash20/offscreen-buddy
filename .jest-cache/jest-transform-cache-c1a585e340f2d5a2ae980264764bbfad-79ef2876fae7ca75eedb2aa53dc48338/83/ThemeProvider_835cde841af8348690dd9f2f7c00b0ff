ca925f9579b3e69527ebda0d76d2fd64
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useThemeValidation = exports.useThemeTypography = exports.useThemeSpacing = exports.useThemeMode = exports.useThemeColors = exports.useTheme = exports.useResponsiveTheme = exports.useDarkMode = exports.themePersistence = exports.themeAnimations = exports.default = exports.ThemeProvider = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _react = _interopRequireWildcard(require("react"));
var _reactNative = require("react-native");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var _theme = require("../tokens/theme");
var _jsxRuntime = require("react/jsx-runtime");
var ThemeContext = (0, _react.createContext)(undefined);
var THEME_STORAGE_KEY = '@offscreen_buddy_theme_preference';
var SYSTEM_THEME_LISTENER_KEY = 'system_theme_listener';
var useTheme = exports.useTheme = function useTheme() {
  var context = (0, _react.useContext)(ThemeContext);
  if (context === undefined) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
};
var ThemeProvider = exports.ThemeProvider = function ThemeProvider(_ref) {
  var children = _ref.children,
    _ref$defaultMode = _ref.defaultMode,
    defaultMode = _ref$defaultMode === void 0 ? 'system' : _ref$defaultMode,
    _ref$enableSystemThem = _ref.enableSystemTheme,
    enableSystemTheme = _ref$enableSystemThem === void 0 ? true : _ref$enableSystemThem,
    _ref$enablePersistenc = _ref.enablePersistence,
    enablePersistence = _ref$enablePersistenc === void 0 ? true : _ref$enablePersistenc,
    _ref$enableAnimations = _ref.enableAnimations,
    enableAnimations = _ref$enableAnimations === void 0 ? true : _ref$enableAnimations;
  var _useState = (0, _react.useState)(defaultMode),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    mode = _useState2[0],
    setMode = _useState2[1];
  var _useState3 = (0, _react.useState)(false),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    systemTheme = _useState4[0],
    setSystemTheme = _useState4[1];
  var _useState5 = (0, _react.useState)(true),
    _useState6 = (0, _slicedToArray2.default)(_useState5, 2),
    isLoading = _useState6[0],
    setIsLoading = _useState6[1];
  var _useState7 = (0, _react.useState)(function () {
      return (0, _theme.createTheme)('light');
    }),
    _useState8 = (0, _slicedToArray2.default)(_useState7, 2),
    currentTheme = _useState8[0],
    setCurrentTheme = _useState8[1];
  (0, _react.useEffect)(function () {
    initializeTheme();
  }, []);
  (0, _react.useEffect)(function () {
    if (!enableSystemTheme) return;
    var subscription = _reactNative.Appearance.addChangeListener(function (_ref2) {
      var colorScheme = _ref2.colorScheme;
      var newSystemTheme = colorScheme === 'dark';
      setSystemTheme(newSystemTheme);
      if (mode === 'system') {
        var effectiveTheme = _theme.themeUtils.getEffectiveTheme('system', newSystemTheme);
        setCurrentTheme((0, _theme.createTheme)(effectiveTheme));
      }
    });
    return function () {
      subscription == null || subscription.remove();
    };
  }, [mode, enableSystemTheme]);
  (0, _react.useEffect)(function () {
    if (!isLoading) {
      updateTheme();
    }
  }, [mode, systemTheme, isLoading]);
  var initializeTheme = function () {
    var _ref3 = (0, _asyncToGenerator2.default)(function* () {
      try {
        setIsLoading(true);
        var currentSystemTheme = _theme.themeUtils.getSystemTheme();
        setSystemTheme(currentSystemTheme);
        var storedMode = defaultMode;
        if (enablePersistence) {
          var stored = yield _asyncStorage.default.getItem(THEME_STORAGE_KEY);
          if (stored && ['light', 'dark', 'system'].includes(stored)) {
            storedMode = stored;
            setMode(storedMode);
          }
        }
        var effectiveTheme = _theme.themeUtils.getEffectiveTheme(storedMode, currentSystemTheme);
        var initialTheme = (0, _theme.createTheme)(effectiveTheme);
        setCurrentTheme(initialTheme);
      } catch (error) {
        console.error('Failed to initialize theme:', error);
        setCurrentTheme((0, _theme.createTheme)('light'));
      } finally {
        setIsLoading(false);
      }
    });
    return function initializeTheme() {
      return _ref3.apply(this, arguments);
    };
  }();
  var updateTheme = function () {
    var _ref4 = (0, _asyncToGenerator2.default)(function* () {
      try {
        var effectiveTheme = _theme.themeUtils.getEffectiveTheme(mode, systemTheme);
        var newTheme = (0, _theme.createTheme)(effectiveTheme);
        setCurrentTheme(newTheme);
        if (enablePersistence) {
          yield _asyncStorage.default.setItem(THEME_STORAGE_KEY, mode);
        }
      } catch (error) {
        console.error('Failed to update theme:', error);
      }
    });
    return function updateTheme() {
      return _ref4.apply(this, arguments);
    };
  }();
  var toggleTheme = function toggleTheme() {
    if (mode === 'system') {
      var newMode = systemTheme ? 'light' : 'dark';
      setMode(newMode);
    } else {
      setMode(mode === 'light' ? 'dark' : 'light');
    }
  };
  var setTheme = function setTheme(newMode) {
    setMode(newMode);
  };
  var getResponsiveTheme = function getResponsiveTheme(width, height) {
    return _theme.themeUtils.createResponsiveTheme(currentTheme, width, height);
  };
  var contextValue = {
    mode: mode,
    theme: currentTheme,
    isDark: mode === 'dark' || mode === 'system' && systemTheme,
    isSystemThemeDark: systemTheme,
    toggleTheme: toggleTheme,
    setTheme: setTheme,
    getResponsiveTheme: getResponsiveTheme,
    isLoading: isLoading
  };
  return (0, _jsxRuntime.jsx)(ThemeContext.Provider, {
    value: contextValue,
    children: children
  });
};
var useThemeMode = exports.useThemeMode = function useThemeMode() {
  var _useTheme = useTheme(),
    mode = _useTheme.mode,
    toggleTheme = _useTheme.toggleTheme,
    setTheme = _useTheme.setTheme,
    isDark = _useTheme.isDark;
  return {
    mode: mode,
    toggleTheme: toggleTheme,
    setTheme: setTheme,
    isDark: isDark
  };
};
var useThemeColors = exports.useThemeColors = function useThemeColors() {
  var _useTheme2 = useTheme(),
    theme = _useTheme2.theme;
  return theme.colors;
};
var useThemeSpacing = exports.useThemeSpacing = function useThemeSpacing() {
  var _useTheme3 = useTheme(),
    theme = _useTheme3.theme;
  return theme.spacing;
};
var useThemeTypography = exports.useThemeTypography = function useThemeTypography() {
  var _useTheme4 = useTheme(),
    theme = _useTheme4.theme;
  return theme.typography;
};
var useResponsiveTheme = exports.useResponsiveTheme = function useResponsiveTheme() {
  var _useTheme5 = useTheme(),
    getResponsiveTheme = _useTheme5.getResponsiveTheme;
  return {
    getResponsiveTheme: getResponsiveTheme
  };
};
var themeAnimations = exports.themeAnimations = {
  getThemeTransitionAnimation: function getThemeTransitionAnimation() {
    var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 300;
    return {
      duration: duration,
      easing: 'easeInOut'
    };
  },
  getBackgroundTransition: function getBackgroundTransition(isDark) {
    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 300;
    return {
      backgroundColor: isDark ? '#000000' : '#FFFFFF',
      transition: {
        duration: duration,
        easing: 'easeInOut'
      }
    };
  },
  getTextTransition: function getTextTransition(isDark) {
    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 300;
    return {
      color: isDark ? '#FFFFFF' : '#000000',
      transition: {
        duration: duration,
        easing: 'easeInOut'
      }
    };
  }
};
var useThemeValidation = exports.useThemeValidation = function useThemeValidation() {
  var _useTheme6 = useTheme(),
    theme = _useTheme6.theme;
  var validateCurrentTheme = function validateCurrentTheme() {
    var _require = require('../tokens/theme'),
      validateTheme = _require.validateTheme;
    return validateTheme(theme);
  };
  return {
    validateCurrentTheme: validateCurrentTheme
  };
};
var useDarkMode = exports.useDarkMode = function useDarkMode() {
  var _useTheme7 = useTheme(),
    isDark = _useTheme7.isDark,
    mode = _useTheme7.mode,
    isSystemThemeDark = _useTheme7.isSystemThemeDark;
  return {
    isDark: isDark,
    mode: mode,
    isSystemThemeDark: isSystemThemeDark,
    isSystemMode: mode === 'system',
    effectiveMode: isDark ? 'dark' : 'light'
  };
};
var themePersistence = exports.themePersistence = {
  clearStoredPreference: function () {
    var _clearStoredPreference = (0, _asyncToGenerator2.default)(function* () {
      try {
        yield _asyncStorage.default.removeItem(THEME_STORAGE_KEY);
      } catch (error) {
        console.error('Failed to clear theme preference:', error);
      }
    });
    function clearStoredPreference() {
      return _clearStoredPreference.apply(this, arguments);
    }
    return clearStoredPreference;
  }(),
  getStoredPreference: function () {
    var _getStoredPreference = (0, _asyncToGenerator2.default)(function* () {
      try {
        var stored = yield _asyncStorage.default.getItem(THEME_STORAGE_KEY);
        return stored ? stored : null;
      } catch (error) {
        console.error('Failed to get stored theme preference:', error);
        return null;
      }
    });
    function getStoredPreference() {
      return _getStoredPreference.apply(this, arguments);
    }
    return getStoredPreference;
  }(),
  setStoredPreference: function () {
    var _setStoredPreference = (0, _asyncToGenerator2.default)(function* (mode) {
      try {
        yield _asyncStorage.default.setItem(THEME_STORAGE_KEY, mode);
      } catch (error) {
        console.error('Failed to set theme preference:', error);
      }
    });
    function setStoredPreference(_x) {
      return _setStoredPreference.apply(this, arguments);
    }
    return setStoredPreference;
  }()
};
var _default = exports.default = ThemeProvider;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfcmVhY3ROYXRpdmUiLCJfYXN5bmNTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl90aGVtZSIsIl9qc3hSdW50aW1lIiwiVGhlbWVDb250ZXh0IiwiY3JlYXRlQ29udGV4dCIsInVuZGVmaW5lZCIsIlRIRU1FX1NUT1JBR0VfS0VZIiwiU1lTVEVNX1RIRU1FX0xJU1RFTkVSX0tFWSIsInVzZVRoZW1lIiwiZXhwb3J0cyIsImNvbnRleHQiLCJ1c2VDb250ZXh0IiwiRXJyb3IiLCJUaGVtZVByb3ZpZGVyIiwiX3JlZiIsImNoaWxkcmVuIiwiX3JlZiRkZWZhdWx0TW9kZSIsImRlZmF1bHRNb2RlIiwiX3JlZiRlbmFibGVTeXN0ZW1UaGVtIiwiZW5hYmxlU3lzdGVtVGhlbWUiLCJfcmVmJGVuYWJsZVBlcnNpc3RlbmMiLCJlbmFibGVQZXJzaXN0ZW5jZSIsIl9yZWYkZW5hYmxlQW5pbWF0aW9ucyIsImVuYWJsZUFuaW1hdGlvbnMiLCJfdXNlU3RhdGUiLCJ1c2VTdGF0ZSIsIl91c2VTdGF0ZTIiLCJfc2xpY2VkVG9BcnJheTIiLCJkZWZhdWx0IiwibW9kZSIsInNldE1vZGUiLCJfdXNlU3RhdGUzIiwiX3VzZVN0YXRlNCIsInN5c3RlbVRoZW1lIiwic2V0U3lzdGVtVGhlbWUiLCJfdXNlU3RhdGU1IiwiX3VzZVN0YXRlNiIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsIl91c2VTdGF0ZTciLCJjcmVhdGVUaGVtZSIsIl91c2VTdGF0ZTgiLCJjdXJyZW50VGhlbWUiLCJzZXRDdXJyZW50VGhlbWUiLCJ1c2VFZmZlY3QiLCJpbml0aWFsaXplVGhlbWUiLCJzdWJzY3JpcHRpb24iLCJBcHBlYXJhbmNlIiwiYWRkQ2hhbmdlTGlzdGVuZXIiLCJfcmVmMiIsImNvbG9yU2NoZW1lIiwibmV3U3lzdGVtVGhlbWUiLCJlZmZlY3RpdmVUaGVtZSIsInRoZW1lVXRpbHMiLCJnZXRFZmZlY3RpdmVUaGVtZSIsInJlbW92ZSIsInVwZGF0ZVRoZW1lIiwiX3JlZjMiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJjdXJyZW50U3lzdGVtVGhlbWUiLCJnZXRTeXN0ZW1UaGVtZSIsInN0b3JlZE1vZGUiLCJzdG9yZWQiLCJBc3luY1N0b3JhZ2UiLCJnZXRJdGVtIiwiaW5jbHVkZXMiLCJpbml0aWFsVGhlbWUiLCJlcnJvciIsImNvbnNvbGUiLCJhcHBseSIsImFyZ3VtZW50cyIsIl9yZWY0IiwibmV3VGhlbWUiLCJzZXRJdGVtIiwidG9nZ2xlVGhlbWUiLCJuZXdNb2RlIiwic2V0VGhlbWUiLCJnZXRSZXNwb25zaXZlVGhlbWUiLCJ3aWR0aCIsImhlaWdodCIsImNyZWF0ZVJlc3BvbnNpdmVUaGVtZSIsImNvbnRleHRWYWx1ZSIsInRoZW1lIiwiaXNEYXJrIiwiaXNTeXN0ZW1UaGVtZURhcmsiLCJqc3giLCJQcm92aWRlciIsInZhbHVlIiwidXNlVGhlbWVNb2RlIiwiX3VzZVRoZW1lIiwidXNlVGhlbWVDb2xvcnMiLCJfdXNlVGhlbWUyIiwiY29sb3JzIiwidXNlVGhlbWVTcGFjaW5nIiwiX3VzZVRoZW1lMyIsInNwYWNpbmciLCJ1c2VUaGVtZVR5cG9ncmFwaHkiLCJfdXNlVGhlbWU0IiwidHlwb2dyYXBoeSIsInVzZVJlc3BvbnNpdmVUaGVtZSIsIl91c2VUaGVtZTUiLCJ0aGVtZUFuaW1hdGlvbnMiLCJnZXRUaGVtZVRyYW5zaXRpb25BbmltYXRpb24iLCJkdXJhdGlvbiIsImxlbmd0aCIsImVhc2luZyIsImdldEJhY2tncm91bmRUcmFuc2l0aW9uIiwiYmFja2dyb3VuZENvbG9yIiwidHJhbnNpdGlvbiIsImdldFRleHRUcmFuc2l0aW9uIiwiY29sb3IiLCJ1c2VUaGVtZVZhbGlkYXRpb24iLCJfdXNlVGhlbWU2IiwidmFsaWRhdGVDdXJyZW50VGhlbWUiLCJfcmVxdWlyZSIsInZhbGlkYXRlVGhlbWUiLCJ1c2VEYXJrTW9kZSIsIl91c2VUaGVtZTciLCJpc1N5c3RlbU1vZGUiLCJlZmZlY3RpdmVNb2RlIiwidGhlbWVQZXJzaXN0ZW5jZSIsImNsZWFyU3RvcmVkUHJlZmVyZW5jZSIsIl9jbGVhclN0b3JlZFByZWZlcmVuY2UiLCJyZW1vdmVJdGVtIiwiZ2V0U3RvcmVkUHJlZmVyZW5jZSIsIl9nZXRTdG9yZWRQcmVmZXJlbmNlIiwic2V0U3RvcmVkUHJlZmVyZW5jZSIsIl9zZXRTdG9yZWRQcmVmZXJlbmNlIiwiX3giLCJfZGVmYXVsdCJdLCJzb3VyY2VzIjpbIlRoZW1lUHJvdmlkZXIudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTW9iaWxlLUZpcnN0IERlc2lnbiBTeXN0ZW0gLSBUaGVtZSBQcm92aWRlclxuICogQ29udGV4dCBwcm92aWRlciBmb3IgdGhlbWUgbWFuYWdlbWVudCB3aXRoIHN5c3RlbSB0aGVtZSBkZXRlY3Rpb24gYW5kIHBlcnNpc3RlbmNlXG4gKi9cblxuaW1wb3J0IFJlYWN0LCB7IGNyZWF0ZUNvbnRleHQsIHVzZUNvbnRleHQsIHVzZVN0YXRlLCB1c2VFZmZlY3QsIFJlYWN0Tm9kZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IEFwcGVhcmFuY2UsIENvbG9yU2NoZW1lTmFtZSB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5pbXBvcnQgQXN5bmNTdG9yYWdlIGZyb20gJ0ByZWFjdC1uYXRpdmUtYXN5bmMtc3RvcmFnZS9hc3luYy1zdG9yYWdlJztcbmltcG9ydCB7IGNyZWF0ZVRoZW1lLCBUaGVtZUNvbmZpZywgVGhlbWVNb2RlLCB0aGVtZVV0aWxzIH0gZnJvbSAnLi4vdG9rZW5zL3RoZW1lJztcblxuaW50ZXJmYWNlIFRoZW1lQ29udGV4dFR5cGUge1xuICAgIC8vIEN1cnJlbnQgdGhlbWUgc3RhdGVcbiAgICBtb2RlOiBUaGVtZU1vZGU7XG4gICAgdGhlbWU6IFRoZW1lQ29uZmlnO1xuICAgIGlzRGFyazogYm9vbGVhbjtcbiAgICBpc1N5c3RlbVRoZW1lRGFyazogYm9vbGVhbjtcblxuICAgIC8vIFRoZW1lIGFjdGlvbnNcbiAgICB0b2dnbGVUaGVtZTogKCkgPT4gdm9pZDtcbiAgICBzZXRUaGVtZTogKG1vZGU6IFRoZW1lTW9kZSkgPT4gdm9pZDtcblxuICAgIC8vIFJlc3BvbnNpdmUgdGhlbWUgdXRpbGl0aWVzXG4gICAgZ2V0UmVzcG9uc2l2ZVRoZW1lOiAod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpID0+IFRoZW1lQ29uZmlnO1xuXG4gICAgLy8gTG9hZGluZyBzdGF0ZVxuICAgIGlzTG9hZGluZzogYm9vbGVhbjtcbn1cblxuY29uc3QgVGhlbWVDb250ZXh0ID0gY3JlYXRlQ29udGV4dDxUaGVtZUNvbnRleHRUeXBlIHwgdW5kZWZpbmVkPih1bmRlZmluZWQpO1xuXG5pbnRlcmZhY2UgVGhlbWVQcm92aWRlclByb3BzIHtcbiAgICBjaGlsZHJlbjogUmVhY3ROb2RlO1xuICAgIGRlZmF1bHRNb2RlPzogVGhlbWVNb2RlO1xuICAgIGVuYWJsZVN5c3RlbVRoZW1lPzogYm9vbGVhbjtcbiAgICBlbmFibGVQZXJzaXN0ZW5jZT86IGJvb2xlYW47XG4gICAgZW5hYmxlQW5pbWF0aW9ucz86IGJvb2xlYW47XG59XG5cbmNvbnN0IFRIRU1FX1NUT1JBR0VfS0VZID0gJ0BvZmZzY3JlZW5fYnVkZHlfdGhlbWVfcHJlZmVyZW5jZSc7XG5jb25zdCBTWVNURU1fVEhFTUVfTElTVEVORVJfS0VZID0gJ3N5c3RlbV90aGVtZV9saXN0ZW5lcic7XG5cbi8vIEhvb2sgdG8gYWNjZXNzIHRoZW1lIGNvbnRleHRcbmV4cG9ydCBjb25zdCB1c2VUaGVtZSA9ICgpID0+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChUaGVtZUNvbnRleHQpO1xuICAgIGlmIChjb250ZXh0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1c2VUaGVtZSBtdXN0IGJlIHVzZWQgd2l0aGluIGEgVGhlbWVQcm92aWRlcicpO1xuICAgIH1cbiAgICByZXR1cm4gY29udGV4dDtcbn07XG5cbi8vIFRoZW1lIHByb3ZpZGVyIGNvbXBvbmVudFxuZXhwb3J0IGNvbnN0IFRoZW1lUHJvdmlkZXI6IFJlYWN0LkZDPFRoZW1lUHJvdmlkZXJQcm9wcz4gPSAoe1xuICAgIGNoaWxkcmVuLFxuICAgIGRlZmF1bHRNb2RlID0gJ3N5c3RlbScsXG4gICAgZW5hYmxlU3lzdGVtVGhlbWUgPSB0cnVlLFxuICAgIGVuYWJsZVBlcnNpc3RlbmNlID0gdHJ1ZSxcbiAgICBlbmFibGVBbmltYXRpb25zID0gdHJ1ZSxcbn0pID0+IHtcbiAgICAvLyBTdGF0ZSBtYW5hZ2VtZW50XG4gICAgY29uc3QgW21vZGUsIHNldE1vZGVdID0gdXNlU3RhdGU8VGhlbWVNb2RlPihkZWZhdWx0TW9kZSk7XG4gICAgY29uc3QgW3N5c3RlbVRoZW1lLCBzZXRTeXN0ZW1UaGVtZV0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XG4gICAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xuICAgIGNvbnN0IFtjdXJyZW50VGhlbWUsIHNldEN1cnJlbnRUaGVtZV0gPSB1c2VTdGF0ZTxUaGVtZUNvbmZpZz4oKCkgPT4gY3JlYXRlVGhlbWUoJ2xpZ2h0JykpO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSB0aGVtZSBzeXN0ZW1cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpbml0aWFsaXplVGhlbWUoKTtcbiAgICB9LCBbXSk7XG5cbiAgICAvLyBMaXN0ZW4gZm9yIHN5c3RlbSB0aGVtZSBjaGFuZ2VzXG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgaWYgKCFlbmFibGVTeXN0ZW1UaGVtZSkgcmV0dXJuO1xuXG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IEFwcGVhcmFuY2UuYWRkQ2hhbmdlTGlzdGVuZXIoKHsgY29sb3JTY2hlbWUgfSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3U3lzdGVtVGhlbWUgPSBjb2xvclNjaGVtZSA9PT0gJ2RhcmsnO1xuICAgICAgICAgICAgc2V0U3lzdGVtVGhlbWUobmV3U3lzdGVtVGhlbWUpO1xuXG4gICAgICAgICAgICAvLyBJZiB1c2luZyBzeXN0ZW0gdGhlbWUsIHVwZGF0ZSBjdXJyZW50IHRoZW1lXG4gICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3N5c3RlbScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlZmZlY3RpdmVUaGVtZSA9IHRoZW1lVXRpbHMuZ2V0RWZmZWN0aXZlVGhlbWUoJ3N5c3RlbScsIG5ld1N5c3RlbVRoZW1lKTtcbiAgICAgICAgICAgICAgICBzZXRDdXJyZW50VGhlbWUoY3JlYXRlVGhlbWUoZWZmZWN0aXZlVGhlbWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbj8ucmVtb3ZlKCk7XG4gICAgICAgIH07XG4gICAgfSwgW21vZGUsIGVuYWJsZVN5c3RlbVRoZW1lXSk7XG5cbiAgICAvLyBVcGRhdGUgdGhlbWUgd2hlbiBtb2RlIGNoYW5nZXNcbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAoIWlzTG9hZGluZykge1xuICAgICAgICAgICAgdXBkYXRlVGhlbWUoKTtcbiAgICAgICAgfVxuICAgIH0sIFttb2RlLCBzeXN0ZW1UaGVtZSwgaXNMb2FkaW5nXSk7XG5cbiAgICAvLyBJbml0aWFsaXplIHRoZW1lIGZyb20gc3RvcmFnZSBhbmQgc3lzdGVtIHByZWZlcmVuY2VcbiAgICBjb25zdCBpbml0aWFsaXplVGhlbWUgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XG5cbiAgICAgICAgICAgIC8vIEdldCBzeXN0ZW0gdGhlbWVcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRTeXN0ZW1UaGVtZSA9IHRoZW1lVXRpbHMuZ2V0U3lzdGVtVGhlbWUoKTtcbiAgICAgICAgICAgIHNldFN5c3RlbVRoZW1lKGN1cnJlbnRTeXN0ZW1UaGVtZSk7XG5cbiAgICAgICAgICAgIC8vIEdldCBzdG9yZWQgcHJlZmVyZW5jZSBvciB1c2UgZGVmYXVsdFxuICAgICAgICAgICAgbGV0IHN0b3JlZE1vZGU6IFRoZW1lTW9kZSA9IGRlZmF1bHRNb2RlO1xuXG4gICAgICAgICAgICBpZiAoZW5hYmxlUGVyc2lzdGVuY2UpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzdG9yZWQgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShUSEVNRV9TVE9SQUdFX0tFWSk7XG4gICAgICAgICAgICAgICAgaWYgKHN0b3JlZCAmJiBbJ2xpZ2h0JywgJ2RhcmsnLCAnc3lzdGVtJ10uaW5jbHVkZXMoc3RvcmVkKSkge1xuICAgICAgICAgICAgICAgICAgICBzdG9yZWRNb2RlID0gc3RvcmVkIGFzIFRoZW1lTW9kZTtcbiAgICAgICAgICAgICAgICAgICAgc2V0TW9kZShzdG9yZWRNb2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENyZWF0ZSBpbml0aWFsIHRoZW1lXG4gICAgICAgICAgICBjb25zdCBlZmZlY3RpdmVUaGVtZSA9IHRoZW1lVXRpbHMuZ2V0RWZmZWN0aXZlVGhlbWUoc3RvcmVkTW9kZSwgY3VycmVudFN5c3RlbVRoZW1lKTtcbiAgICAgICAgICAgIGNvbnN0IGluaXRpYWxUaGVtZSA9IGNyZWF0ZVRoZW1lKGVmZmVjdGl2ZVRoZW1lKTtcbiAgICAgICAgICAgIHNldEN1cnJlbnRUaGVtZShpbml0aWFsVGhlbWUpO1xuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSB0aGVtZTonLCBlcnJvcik7XG4gICAgICAgICAgICAvLyBGYWxsYmFjayB0byBkZWZhdWx0IHRoZW1lXG4gICAgICAgICAgICBzZXRDdXJyZW50VGhlbWUoY3JlYXRlVGhlbWUoJ2xpZ2h0JykpO1xuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBVcGRhdGUgY3VycmVudCB0aGVtZSBiYXNlZCBvbiBtb2RlXG4gICAgY29uc3QgdXBkYXRlVGhlbWUgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlZmZlY3RpdmVUaGVtZSA9IHRoZW1lVXRpbHMuZ2V0RWZmZWN0aXZlVGhlbWUobW9kZSwgc3lzdGVtVGhlbWUpO1xuICAgICAgICAgICAgY29uc3QgbmV3VGhlbWUgPSBjcmVhdGVUaGVtZShlZmZlY3RpdmVUaGVtZSk7XG4gICAgICAgICAgICBzZXRDdXJyZW50VGhlbWUobmV3VGhlbWUpO1xuXG4gICAgICAgICAgICAvLyBQZXJzaXN0IHByZWZlcmVuY2VcbiAgICAgICAgICAgIGlmIChlbmFibGVQZXJzaXN0ZW5jZSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKFRIRU1FX1NUT1JBR0VfS0VZLCBtb2RlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHVwZGF0ZSB0aGVtZTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gVG9nZ2xlIGJldHdlZW4gbGlnaHQgYW5kIGRhcmsgdGhlbWVzXG4gICAgY29uc3QgdG9nZ2xlVGhlbWUgPSAoKSA9PiB7XG4gICAgICAgIGlmIChtb2RlID09PSAnc3lzdGVtJykge1xuICAgICAgICAgICAgLy8gSWYgdXNpbmcgc3lzdGVtIHRoZW1lLCBzd2l0Y2ggdG8gdGhlIG9wcG9zaXRlIG9mIGN1cnJlbnQgc3lzdGVtIHRoZW1lXG4gICAgICAgICAgICBjb25zdCBuZXdNb2RlID0gc3lzdGVtVGhlbWUgPyAnbGlnaHQnIDogJ2RhcmsnO1xuICAgICAgICAgICAgc2V0TW9kZShuZXdNb2RlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFRvZ2dsZSBiZXR3ZWVuIGxpZ2h0IGFuZCBkYXJrXG4gICAgICAgICAgICBzZXRNb2RlKG1vZGUgPT09ICdsaWdodCcgPyAnZGFyaycgOiAnbGlnaHQnKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBTZXQgc3BlY2lmaWMgdGhlbWUgbW9kZVxuICAgIGNvbnN0IHNldFRoZW1lID0gKG5ld01vZGU6IFRoZW1lTW9kZSkgPT4ge1xuICAgICAgICBzZXRNb2RlKG5ld01vZGUpO1xuICAgIH07XG5cbiAgICAvLyBHZXQgcmVzcG9uc2l2ZSB0aGVtZSB2YXJpYW50XG4gICAgY29uc3QgZ2V0UmVzcG9uc2l2ZVRoZW1lID0gKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKTogVGhlbWVDb25maWcgPT4ge1xuICAgICAgICByZXR1cm4gdGhlbWVVdGlscy5jcmVhdGVSZXNwb25zaXZlVGhlbWUoY3VycmVudFRoZW1lLCB3aWR0aCwgaGVpZ2h0KTtcbiAgICB9O1xuXG4gICAgLy8gQ29udGV4dCB2YWx1ZVxuICAgIGNvbnN0IGNvbnRleHRWYWx1ZTogVGhlbWVDb250ZXh0VHlwZSA9IHtcbiAgICAgICAgbW9kZSxcbiAgICAgICAgdGhlbWU6IGN1cnJlbnRUaGVtZSxcbiAgICAgICAgaXNEYXJrOiBtb2RlID09PSAnZGFyaycgfHwgKG1vZGUgPT09ICdzeXN0ZW0nICYmIHN5c3RlbVRoZW1lKSxcbiAgICAgICAgaXNTeXN0ZW1UaGVtZURhcms6IHN5c3RlbVRoZW1lLFxuICAgICAgICB0b2dnbGVUaGVtZSxcbiAgICAgICAgc2V0VGhlbWUsXG4gICAgICAgIGdldFJlc3BvbnNpdmVUaGVtZSxcbiAgICAgICAgaXNMb2FkaW5nLFxuICAgIH07XG5cbiAgICByZXR1cm4gKFxuICAgICAgICA8VGhlbWVDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtjb250ZXh0VmFsdWV9PlxuICAgICAgICAgICAge2NoaWxkcmVufVxuICAgICAgICA8L1RoZW1lQ29udGV4dC5Qcm92aWRlcj5cbiAgICApO1xufTtcblxuLy8gVGhlbWUgaG9vayBmb3IgY29tcG9uZW50c1xuZXhwb3J0IGNvbnN0IHVzZVRoZW1lTW9kZSA9ICgpID0+IHtcbiAgICBjb25zdCB7IG1vZGUsIHRvZ2dsZVRoZW1lLCBzZXRUaGVtZSwgaXNEYXJrIH0gPSB1c2VUaGVtZSgpO1xuICAgIHJldHVybiB7IG1vZGUsIHRvZ2dsZVRoZW1lLCBzZXRUaGVtZSwgaXNEYXJrIH07XG59O1xuXG4vLyBUaGVtZSBjb2xvcnMgaG9vayBmb3IgY29udmVuaWVuY2VcbmV4cG9ydCBjb25zdCB1c2VUaGVtZUNvbG9ycyA9ICgpID0+IHtcbiAgICBjb25zdCB7IHRoZW1lIH0gPSB1c2VUaGVtZSgpO1xuICAgIHJldHVybiB0aGVtZS5jb2xvcnM7XG59O1xuXG4vLyBUaGVtZSBzcGFjaW5nIGhvb2tcbmV4cG9ydCBjb25zdCB1c2VUaGVtZVNwYWNpbmcgPSAoKSA9PiB7XG4gICAgY29uc3QgeyB0aGVtZSB9ID0gdXNlVGhlbWUoKTtcbiAgICByZXR1cm4gdGhlbWUuc3BhY2luZztcbn07XG5cbi8vIFRoZW1lIHR5cG9ncmFwaHkgaG9va1xuZXhwb3J0IGNvbnN0IHVzZVRoZW1lVHlwb2dyYXBoeSA9ICgpID0+IHtcbiAgICBjb25zdCB7IHRoZW1lIH0gPSB1c2VUaGVtZSgpO1xuICAgIHJldHVybiB0aGVtZS50eXBvZ3JhcGh5O1xufTtcblxuLy8gUmVzcG9uc2l2ZSB0aGVtZSBob29rXG5leHBvcnQgY29uc3QgdXNlUmVzcG9uc2l2ZVRoZW1lID0gKCkgPT4ge1xuICAgIGNvbnN0IHsgZ2V0UmVzcG9uc2l2ZVRoZW1lIH0gPSB1c2VUaGVtZSgpO1xuICAgIHJldHVybiB7IGdldFJlc3BvbnNpdmVUaGVtZSB9O1xufTtcblxuLy8gVGhlbWUgYW5pbWF0aW9uIHV0aWxpdGllc1xuZXhwb3J0IGNvbnN0IHRoZW1lQW5pbWF0aW9ucyA9IHtcbiAgICAvLyBTbW9vdGggdGhlbWUgdHJhbnNpdGlvbiBhbmltYXRpb25cbiAgICBnZXRUaGVtZVRyYW5zaXRpb25BbmltYXRpb246IChkdXJhdGlvbjogbnVtYmVyID0gMzAwKSA9PiAoe1xuICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgZWFzaW5nOiAnZWFzZUluT3V0JyxcbiAgICB9KSxcblxuICAgIC8vIEJhY2tncm91bmQgY29sb3IgdHJhbnNpdGlvblxuICAgIGdldEJhY2tncm91bmRUcmFuc2l0aW9uOiAoaXNEYXJrOiBib29sZWFuLCBkdXJhdGlvbjogbnVtYmVyID0gMzAwKSA9PiAoe1xuICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IGlzRGFyayA/ICcjMDAwMDAwJyA6ICcjRkZGRkZGJyxcbiAgICAgICAgdHJhbnNpdGlvbjoge1xuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBlYXNpbmc6ICdlYXNlSW5PdXQnLFxuICAgICAgICB9LFxuICAgIH0pLFxuXG4gICAgLy8gVGV4dCBjb2xvciB0cmFuc2l0aW9uXG4gICAgZ2V0VGV4dFRyYW5zaXRpb246IChpc0Rhcms6IGJvb2xlYW4sIGR1cmF0aW9uOiBudW1iZXIgPSAzMDApID0+ICh7XG4gICAgICAgIGNvbG9yOiBpc0RhcmsgPyAnI0ZGRkZGRicgOiAnIzAwMDAwMCcsXG4gICAgICAgIHRyYW5zaXRpb246IHtcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgZWFzaW5nOiAnZWFzZUluT3V0JyxcbiAgICAgICAgfSxcbiAgICB9KSxcbn07XG5cbi8vIFRoZW1lIHZhbGlkYXRpb24gaG9va1xuZXhwb3J0IGNvbnN0IHVzZVRoZW1lVmFsaWRhdGlvbiA9ICgpID0+IHtcbiAgICBjb25zdCB7IHRoZW1lIH0gPSB1c2VUaGVtZSgpO1xuXG4gICAgY29uc3QgdmFsaWRhdGVDdXJyZW50VGhlbWUgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgdmFsaWRhdGVUaGVtZSB9ID0gcmVxdWlyZSgnLi4vdG9rZW5zL3RoZW1lJyk7XG4gICAgICAgIHJldHVybiB2YWxpZGF0ZVRoZW1lKHRoZW1lKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHsgdmFsaWRhdGVDdXJyZW50VGhlbWUgfTtcbn07XG5cbi8vIERhcmsgbW9kZSBob29rXG5leHBvcnQgY29uc3QgdXNlRGFya01vZGUgPSAoKSA9PiB7XG4gICAgY29uc3QgeyBpc0RhcmssIG1vZGUsIGlzU3lzdGVtVGhlbWVEYXJrIH0gPSB1c2VUaGVtZSgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaXNEYXJrLFxuICAgICAgICBtb2RlLFxuICAgICAgICBpc1N5c3RlbVRoZW1lRGFyayxcbiAgICAgICAgaXNTeXN0ZW1Nb2RlOiBtb2RlID09PSAnc3lzdGVtJyxcbiAgICAgICAgZWZmZWN0aXZlTW9kZTogaXNEYXJrID8gJ2RhcmsnIGFzIGNvbnN0IDogJ2xpZ2h0JyBhcyBjb25zdCxcbiAgICB9O1xufTtcblxuLy8gVGhlbWUgcGVyc2lzdGVuY2UgdXRpbGl0aWVzXG5leHBvcnQgY29uc3QgdGhlbWVQZXJzaXN0ZW5jZSA9IHtcbiAgICAvLyBDbGVhciBzdG9yZWQgdGhlbWUgcHJlZmVyZW5jZVxuICAgIGNsZWFyU3RvcmVkUHJlZmVyZW5jZTogYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0oVEhFTUVfU1RPUkFHRV9LRVkpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNsZWFyIHRoZW1lIHByZWZlcmVuY2U6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8vIEdldCBzdG9yZWQgdGhlbWUgcHJlZmVyZW5jZVxuICAgIGdldFN0b3JlZFByZWZlcmVuY2U6IGFzeW5jICgpOiBQcm9taXNlPFRoZW1lTW9kZSB8IG51bGw+ID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHN0b3JlZCA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKFRIRU1FX1NUT1JBR0VfS0VZKTtcbiAgICAgICAgICAgIHJldHVybiBzdG9yZWQgPyAoc3RvcmVkIGFzIFRoZW1lTW9kZSkgOiBudWxsO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBzdG9yZWQgdGhlbWUgcHJlZmVyZW5jZTonLCBlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvLyBTZXQgdGhlbWUgcHJlZmVyZW5jZVxuICAgIHNldFN0b3JlZFByZWZlcmVuY2U6IGFzeW5jIChtb2RlOiBUaGVtZU1vZGUpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKFRIRU1FX1NUT1JBR0VfS0VZLCBtb2RlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzZXQgdGhlbWUgcHJlZmVyZW5jZTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9LFxufTtcblxuLy8gRXhwb3J0IHByb3ZpZGVyIGFuZCBob29rc1xuZXhwb3J0IGRlZmF1bHQgVGhlbWVQcm92aWRlcjsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBS0EsSUFBQUEsTUFBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsWUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsYUFBQSxHQUFBQyxzQkFBQSxDQUFBSCxPQUFBO0FBQ0EsSUFBQUksTUFBQSxHQUFBSixPQUFBO0FBQWtGLElBQUFLLFdBQUEsR0FBQUwsT0FBQTtBQW9CbEYsSUFBTU0sWUFBWSxHQUFHLElBQUFDLG9CQUFhLEVBQStCQyxTQUFTLENBQUM7QUFVM0UsSUFBTUMsaUJBQWlCLEdBQUcsbUNBQW1DO0FBQzdELElBQU1DLHlCQUF5QixHQUFHLHVCQUF1QjtBQUdsRCxJQUFN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