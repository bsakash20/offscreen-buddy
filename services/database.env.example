# =============================================================================
# DATABASE CONFIGURATION TEMPLATE
# =============================================================================
# Comprehensive configuration template for database services including
# PostgreSQL, Redis, MongoDB, and other database systems.
#
# Copy this file to services/.env and configure according to your environment.
#
# SECURITY CLASSIFICATION:
# [SENSITIVE] - Contains secrets, must be secured and never committed
# [CONFIG] - Configuration values, can be committed with review
# [DATABASE] - Database-specific configuration
# =============================================================================

# -----------------------------------------------------------------------------
# POSTGRESQL CONFIGURATION
# -----------------------------------------------------------------------------
# [SENSITIVE] PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://username:password@localhost:5432/database_name

# [SENSITIVE] Individual PostgreSQL connection parameters
DB_HOST=localhost
DB_PORT=5432
DB_NAME=offscreen_buddy
DB_USER=postgres
DB_PASSWORD=your_database_password

# [SENSITIVE] PostgreSQL admin credentials (for migrations)
DB_ADMIN_USER=postgres
DB_ADMIN_PASSWORD=your_admin_password

# [CONFIG] PostgreSQL connection pool settings
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_ACQUIRE_TIMEOUT=60000
DB_POOL_IDLE_TIMEOUT=300000
DB_POOL_CREATE_TIMEOUT=60000
DB_POOL_DESTROY_TIMEOUT=5000

# [CONFIG] PostgreSQL SSL configuration
DB_SSL_ENABLED=false
DB_SSL_REJECT_UNAUTHORIZED=true
DB_SSL_CA_FILE=
DB_SSL_CERT_FILE=
DB_SSL_KEY_FILE=

# [CONFIG] PostgreSQL query settings
DB_QUERY_TIMEOUT=30000
DB_STATEMENT_TIMEOUT=30000
DB_LOCK_TIMEOUT=10000

# [CONFIG] PostgreSQL logging
DB_LOG_QUERIES=false
DB_LOG_CONNECTIONS=false
DB_LOG_DISCONNECTIONS=false

# -----------------------------------------------------------------------------
# REDIS CONFIGURATION
# -----------------------------------------------------------------------------
# [SENSITIVE] Redis connection URL
REDIS_URL=redis://localhost:6379

# [SENSITIVE] Individual Redis connection parameters
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=your_redis_password
REDIS_DB=0

# [CONFIG] Redis connection settings
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000
REDIS_ENABLE_OFFLINE_QUEUE=true
REDIS_ENABLE_READY_CHECK=true
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=100

# [CONFIG] Redis cluster configuration (if using cluster)
REDIS_CLUSTER_ENABLED=false
REDIS_CLUSTER_NODES=redis-node-1:6379,redis-node-2:6379,redis-node-3:6379

# [CONFIG] Redis TLS configuration
REDIS_TLS_ENABLED=false
REDIS_TLS_REJECT_UNAUTHORIZED=true

# [CONFIG] Redis performance settings
REDIS_KEY_PREFIX=offscreen_buddy:
REDIS_DEFAULT_TTL=3600
REDIS_MAX_MEMORY_POLICY=allkeys-lru

# -----------------------------------------------------------------------------
# MONGODB CONFIGURATION (Optional)
# -----------------------------------------------------------------------------
# [SENSITIVE] MongoDB connection string
MONGODB_URL=mongodb://username:password@localhost:27017/database_name

# [SENSITIVE] Individual MongoDB parameters
MONGO_HOST=localhost
MONGO_PORT=27017
MONGO_DB_NAME=offscreen_buddy
MONGO_USER=mongo_user
MONGO_PASSWORD=your_mongo_password

# [CONFIG] MongoDB connection settings
MONGO_CONNECT_TIMEOUT=30000
MONGO_SERVER_SELECTION_TIMEOUT=30000
MONGO_SOCKET_TIMEOUT=30000
MONGO_MAX_POOL_SIZE=10
MONGO_MIN_POOL_SIZE=5

# [CONFIG] MongoDB SSL configuration
MONGO_SSL_ENABLED=false
MONGO_SSL_REJECT_UNAUTHORIZED=true

# -----------------------------------------------------------------------------
# DATABASE MIGRATIONS
# -----------------------------------------------------------------------------
# [CONFIG] Enable automatic migrations
DB_MIGRATIONS_ENABLED=true

# [CONFIG] Migration table name
DB_MIGRATION_TABLE=schema_migrations

# [CONFIG] Migration directory path
DB_MIGRATION_PATH=./migrations

# [CONFIG] Migration timeout
DB_MIGRATION_TIMEOUT=60000

# [CONFIG] Seed database on startup
DB_SEED_ENABLED=false
DB_SEED_PATH=./seeds

# -----------------------------------------------------------------------------
# DATABASE BACKUP CONFIGURATION
# -----------------------------------------------------------------------------
# [CONFIG] Enable automatic backups
DB_BACKUP_ENABLED=true

# [CONFIG] Backup schedule (cron format)
DB_BACKUP_SCHEDULE=0 2 * * *

# [CONFIG] Backup retention period (days)
DB_BACKUP_RETENTION_DAYS=30

# [SENSITIVE] Backup storage endpoint
DB_BACKUP_STORAGE_ENDPOINT=s3://your-backup-bucket

# [SENSITIVE] Backup storage credentials
DB_BACKUP_STORAGE_ACCESS_KEY=your_s3_access_key
DB_BACKUP_STORAGE_SECRET_KEY=your_s3_secret_key

# [CONFIG] Backup compression enabled
DB_BACKUP_COMPRESSION_ENABLED=true

# [CONFIG] Backup encryption enabled
DB_BACKUP_ENCRYPTION_ENABLED=true

# -----------------------------------------------------------------------------
# DATABASE MONITORING
# -----------------------------------------------------------------------------
# [CONFIG] Enable database monitoring
DB_MONITORING_ENABLED=true

# [CONFIG] Database monitoring interval (seconds)
DB_MONITORING_INTERVAL=60

# [SENSITIVE] Database monitoring endpoint
DB_MONITORING_ENDPOINT=https://your-db-monitoring.com

# [SENSITIVE] Database monitoring API key
DB_MONITORING_API_KEY=your_monitoring_api_key

# [CONFIG] Monitor database connections
DB_MONITOR_CONNECTIONS=true

# [CONFIG] Monitor query performance
DB_MONITOR_QUERIES=true

# [CONFIG] Monitor database size
DB_MONITOR_SIZE=true

# [CONFIG] Slow query threshold (milliseconds)
DB_SLOW_QUERY_THRESHOLD=1000

# -----------------------------------------------------------------------------
# CONNECTION POOLING
# -----------------------------------------------------------------------------
# [CONFIG] Enable connection pooling
CONNECTION_POOLING_ENABLED=true

# [CONFIG] Connection pool monitoring
CONNECTION_POOL_MONITORING=true

# [CONFIG] Connection leak detection
CONNECTION_LEAK_DETECTION=false

# [CONFIG] Connection validation on borrow
CONNECTION_VALIDATION=true

# [CONFIG] Test query for connection validation
CONNECTION_TEST_QUERY=SELECT 1

# -----------------------------------------------------------------------------
# DATABASE SECURITY
# -----------------------------------------------------------------------------
# [CONFIG] Enable database encryption at rest
DB_ENCRYPTION_AT_REST=false

# [CONFIG] Enable database encryption in transit
DB_ENCRYPTION_IN_TRANSIT=true

# [CONFIG] Database access audit logging
DB_ACCESS_AUDIT_LOGGING=false

# [CONFIG] Failed connection attempt logging
DB_FAILED_CONNECTION_LOGGING=true

# [CONFIG] Database user privileges
DB_USER_PRIVILEGES=SELECT,INSERT,UPDATE,DELETE

# [CONFIG] Read-only database user (if separate)
DB_READ_ONLY_USER=readonly_user
DB_READ_ONLY_PASSWORD=readonly_password

# -----------------------------------------------------------------------------
# DATABASE PERFORMANCE
# -----------------------------------------------------------------------------
# [CONFIG] Enable query plan caching
DB_QUERY_PLAN_CACHE_ENABLED=true

# [CONFIG] Query plan cache size
DB_QUERY_PLAN_CACHE_SIZE=1000

# [CONFIG] Enable result set caching
DB_RESULT_CACHE_ENABLED=false

# [CONFIG] Result cache TTL
DB_RESULT_CACHE_TTL=300

# [CONFIG] Enable database indexing recommendations
DB_INDEX_RECOMMENDATIONS_ENABLED=false

# [CONFIG] Analyze query performance periodically
DB_PERFORMANCE_ANALYSIS_ENABLED=false

# -----------------------------------------------------------------------------
# DATABASE HIGH AVAILABILITY
# -----------------------------------------------------------------------------
# [CONFIG] Enable database replication
DB_REPLICATION_ENABLED=false

# [SENSITIVE] Primary database connection
DB_PRIMARY_URL=postgresql://primary_user:password@primary-host:5432/database

# [SENSITIVE] Replica database connection
DB_REPLICA_URL=postgresql://replica_user:password@replica-host:5432/database

# [CONFIG] Read-write splitting
DB_READ_WRITE_SPLITTING=false

# [CONFIG] Connection routing strategy
DB_ROUTING_STRATEGY=round_robin

# -----------------------------------------------------------------------------
# DATABASE LOCAL DEVELOPMENT
# -----------------------------------------------------------------------------
# [LOCAL] Local PostgreSQL settings
LOCAL_DB_HOST=localhost
LOCAL_DB_PORT=5432
LOCAL_DB_NAME=offscreen_buddy_dev
LOCAL_DB_USER=postgres
LOCAL_DB_PASSWORD=postgres

# [LOCAL] Local Redis settings
LOCAL_REDIS_HOST=localhost
LOCAL_REDIS_PORT=6379
LOCAL_REDIS_PASSWORD=
LOCAL_REDIS_DB=0

# [LOCAL] Local MongoDB settings (if used)
LOCAL_MONGO_HOST=localhost
LOCAL_MONGO_PORT=27017
LOCAL_MONGO_DB_NAME=offscreen_buddy_dev
LOCAL_MONGO_USER=
LOCAL_MONGO_PASSWORD=

# [LOCAL] Development connection pooling (smaller pools)
LOCAL_DB_POOL_MIN=1
LOCAL_DB_POOL_MAX=5

# [LOCAL] Development logging
LOCAL_DB_LOG_QUERIES=true
LOCAL_DB_LOG_CONNECTIONS=true

# -----------------------------------------------------------------------------
# DATABASE PRODUCTION SETTINGS
# -----------------------------------------------------------------------------
# [PROD] Production PostgreSQL settings
PROD_DB_HOST=your-prod-db-host.com
PROD_DB_PORT=5432
PROD_DB_NAME=offscreen_buddy_prod
PROD_DB_USER=offscreen_prod_user
PROD_DB_PASSWORD=your_production_db_password

# [PROD] Production Redis settings
PROD_REDIS_HOST=your-redis-cluster.com
PROD_REDIS_PORT=6379
PROD_REDIS_PASSWORD=your_redis_password
PROD_REDIS_DB=0

# [PROD] Production MongoDB settings (if used)
PROD_MONGO_HOST=your-mongo-cluster.com
PROD_MONGO_PORT=27017
PROD_MONGO_DB_NAME=offscreen_buddy_prod
PROD_MONGO_USER=mongo_prod_user
PROD_MONGO_PASSWORD=your_production_mongo_password

# [PROD] Production connection pooling (larger pools)
PROD_DB_POOL_MIN=10
PROD_DB_POOL_MAX=50

# [PROD] Production security settings
PROD_DB_SSL_ENABLED=true
PROD_DB_ENCRYPTION_AT_REST=true
PROD_DB_ACCESS_AUDIT_LOGGING=true

# -----------------------------------------------------------------------------
# DATABASE ENVIRONMENT VARIABLES
# -----------------------------------------------------------------------------
# LOCAL Environment Variables
DATABASE_URL_LOCAL=postgresql://postgres:postgres@localhost:5432/offscreen_buddy_dev
REDIS_URL_LOCAL=redis://localhost:6379/0

# PROD Environment Variables
DATABASE_URL_PROD=postgresql://offscreen_prod_user:password@prod-host:5432/offscreen_buddy_prod
REDIS_URL_PROD=redis://prod-redis-cluster:6379/0

# -----------------------------------------------------------------------------
# DATABASE CONNECTION EXAMPLES
# -----------------------------------------------------------------------------
# Standard PostgreSQL connection
# DATABASE_URL=postgresql://username:password@localhost:5432/database

# PostgreSQL with SSL
# DATABASE_URL=postgresql://username:password@localhost:5432/database?sslmode=require

# PostgreSQL with connection pool
# DATABASE_URL=postgresql://username:password@localhost:5432/database?pool_min=5&pool_max=20

# Redis with authentication
# REDIS_URL=redis://username:password@localhost:6379/0

# Redis with SSL
# REDIS_URL=rediss://username:password@localhost:6379/0

# MongoDB with authentication
# MONGODB_URL=mongodb://username:password@localhost:27017/database

# MongoDB with SSL
# MONGODB_URL=mongodb://username:password@localhost:27017/database?ssl=true

# -----------------------------------------------------------------------------
# DATABASE INTEGRATION EXAMPLES
# -----------------------------------------------------------------------------
# Frontend Database Configuration
EXPO_PUBLIC_DATABASE_HOST=${DB_HOST}
EXPO_PUBLIC_DATABASE_PORT=${DB_PORT}
EXPO_PUBLIC_DATABASE_NAME=${DB_NAME}

# Backend Database Configuration
DATABASE_URL=${DATABASE_URL}
DB_POOL_MIN=${DB_POOL_MIN}
DB_POOL_MAX=${DB_POOL_MAX}

# Cache Configuration
REDIS_URL=${REDIS_URL}
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_DB=${REDIS_DB}

# -----------------------------------------------------------------------------
# DATABASE SECURITY BEST PRACTICES
# -----------------------------------------------------------------------------
#
# SECURITY GUIDELINES:
#
# 1. NEVER commit database passwords to version control
# 2. Use strong, unique passwords for database accounts
# 3. Limit database user privileges to minimum required
# 4. Enable SSL/TLS for all database connections
# 5. Use connection pooling with appropriate limits
# 6. Implement proper access controls and firewall rules
# 7. Enable audit logging for sensitive operations
# 8. Regular security updates and patching
# 9. Backup database regularly with encryption
# 10. Monitor database access and performance
#
# CONNECTION SECURITY:
# - Use SSL/TLS for all database connections
# - Implement connection authentication
# - Use connection pooling with timeouts
# - Enable connection encryption
# - Monitor connection attempts and failures
# - Implement connection rate limiting
#
# DATA SECURITY:
# - Enable encryption at rest
# - Implement data masking for sensitive fields
# - Use secure backup storage
# - Regular data integrity checks
# - Implement data retention policies
# - Secure data deletion procedures
#
# ACCESS CONTROL:
# - Create separate users for different access levels
# - Implement principle of least privilege
# - Use role-based access control
# - Regular access review and cleanup
# - Enable multi-factor authentication for admin access
# - Implement IP whitelisting where possible
#
# MONITORING AND ALERTING:
# - Monitor database performance metrics
# - Alert on connection failures
# - Track query performance and slow queries
# - Monitor database size and growth
# - Alert on unusual access patterns
# - Monitor backup success and integrity
#
# SETUP INSTRUCTIONS:
# 1. Install and configure database systems
# 2. Create application database users with minimal privileges
# 3. Set up SSL/TLS certificates for secure connections
# 4. Configure connection pooling parameters
# 5. Set up monitoring and alerting
# 6. Configure automated backups
# 7. Test database connectivity and performance
# 8. Implement database migration scripts
#
# PERFORMANCE OPTIMIZATION:
# - Configure appropriate connection pool sizes
# - Optimize database configuration parameters
# - Implement query optimization and indexing
# - Use read replicas for read-heavy workloads
# - Configure caching strategies
# - Monitor and tune database performance
#
# BACKUP AND RECOVERY:
# - Implement automated backup procedures
# - Test backup and recovery processes regularly
# - Configure appropriate backup retention
# - Implement point-in-time recovery
# - Monitor backup storage and costs
# - Document recovery procedures
#
# TROUBLESHOOTING:
# - Check database connection parameters
# - Verify SSL/TLS certificate validity
# - Monitor connection pool utilization
# - Review database error logs
# - Check network connectivity and firewalls
# - Monitor resource utilization (CPU, memory, disk)
#
# =============================================================================